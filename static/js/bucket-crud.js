function g(u,o,c,n,e,t,a){try{var i=u[t](a),s=i.value}catch(r){c(r);return}i.done?o(s):Promise.resolve(s).then(n,e)}function k(u){return function(){var o=this,c=arguments;return new Promise(function(n,e){var t=u.apply(o,c);function a(s){g(t,n,e,a,i,"next",s)}function i(s){g(t,n,e,a,i,"throw",s)}a(void 0)})}}function P(u,o,c){return o in u?Object.defineProperty(u,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):u[o]=c,u}function p(u){for(var o=1;o<arguments.length;o++){var c=arguments[o]!=null?arguments[o]:{},n=Object.keys(c);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(c).filter(function(e){return Object.getOwnPropertyDescriptor(c,e).enumerable}))),n.forEach(function(e){P(u,e,c[e])})}return u}function x(u,o){var c=Object.keys(u);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(u);o&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(u,e).enumerable})),c.push.apply(c,n)}return c}function w(u,o){return o=o??{},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(o)):x(Object(o)).forEach(function(c){Object.defineProperty(u,c,Object.getOwnPropertyDescriptor(o,c))}),u}function B(u){"@swc/helpers - typeof";return u&&typeof Symbol<"u"&&u.constructor===Symbol?"symbol":typeof u}function E(u,o){var c,n,e,t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(r){return function(l){return s([r,l])}}function s(r){if(c)throw new TypeError("Generator is already executing.");for(;a&&(a=0,r[0]&&(t=0)),t;)try{if(c=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=o.call(u,t)}catch(l){r=[6,l],n=0}finally{c=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}}var b=null;function C(){return k(function(){var u,o,c;return E(this,function(n){switch(n.label){case 0:if(b)return[2,b];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch("/admin/api/csrf-token")];case 2:if(u=n.sent(),!u.ok)throw new Error("Failed to fetch CSRF token");return[4,u.json()];case 3:return o=n.sent(),b=o.csrf_token,[2,b];case 4:throw c=n.sent(),console.error("Error fetching CSRF token:",c),c;case 5:return[2]}})})()}function h(u){return k(function(o){var c,n,e,t=arguments;return E(this,function(a){switch(a.label){case 0:return c=t.length>1&&t[1]!==void 0?t[1]:{},[4,C()];case 1:return n=a.sent(),e=w(p({},c.headers),{"X-CSRF-Token":n}),c.body&&B(c.body)==="object"&&(e["Content-Type"]="application/json",c.body=JSON.stringify(c.body)),[2,fetch(o,w(p({},c),{headers:e}))]}})}).apply(this,arguments)}function O(u,o,c,n,e,t,a){try{var i=u[t](a),s=i.value}catch(r){c(r);return}i.done?o(s):Promise.resolve(s).then(n,e)}function m(u){return function(){var o=this,c=arguments;return new Promise(function(n,e){var t=u.apply(o,c);function a(s){O(t,n,e,a,i,"next",s)}function i(s){O(t,n,e,a,i,"throw",s)}a(void 0)})}}function I(u,o){return o!=null&&typeof Symbol<"u"&&o[Symbol.hasInstance]?!!o[Symbol.hasInstance](u):u instanceof o}function y(u,o){var c,n,e,t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(r){return function(l){return s([r,l])}}function s(r){if(c)throw new TypeError("Generator is already executing.");for(;a&&(a=0,r[0]&&(t=0)),t;)try{if(c=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=o.call(u,t)}catch(l){r=[6,l],n=0}finally{c=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}}function D(u){return m(function(){var o,c,n,e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),[4,h("/admin/api/buckets",{method:"POST",body:JSON.stringify({bucket_name:u}),headers:{"Content-Type":"application/json"}})];case 1:return o=t.sent(),o.ok?[3,3]:[4,o.text()];case 2:throw c=t.sent(),new Error("Failed to create bucket: ".concat(c));case 3:return[4,o.json()];case 4:return n=t.sent(),[2,n];case 5:throw e=t.sent(),console.error("Error creating bucket:",e),e;case 6:return[2]}})})()}function F(){var u=document.getElementById("bucket-form");u&&u.addEventListener("submit",function(o){return m(function(){var c,n,e,t,a;return y(this,function(i){switch(i.label){case 0:o.preventDefault(),c=document.getElementById("bucket-name"),n=c.value,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,D(n)];case 2:return i.sent(),e=encodeURIComponent(n),window.location.href="/admin/buckets/".concat(e),[3,4];case 3:return t=i.sent(),a=I(t,Error)?t.message:String(t),j(a),[3,4];case 4:return[2]}})})()})}function j(u){var o=document.getElementById("bucket-form")||document.getElementById("bucket-delete-form");if(o){var c=o.querySelector(".error-message");c&&c.remove();var n=document.createElement("div");n.className="error-message",n.textContent="Error: ".concat(u),o.insertBefore(n,o.firstChild)}}function N(u){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return m(function(){var c,n,e,t,a,i;return y(this,function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),c=encodeURIComponent(u),n=o?"/admin/api/buckets/".concat(c,"?force=true"):"/admin/api/buckets/".concat(c),[4,h(n,{method:"DELETE"})];case 1:return e=s.sent(),e.ok?[3,3]:[4,e.text()];case 2:throw t=s.sent(),new Error("Failed to delete bucket: ".concat(t));case 3:return[4,e.json()];case 4:return a=s.sent(),[2,a];case 5:throw i=s.sent(),console.error("Error deleting bucket:",i),i;case 6:return[2]}})})()}function T(){var u=document.getElementById("bucket-delete-form");if(!u)return;var o=document.getElementById("bucket-name"),c=o.value,n=document.getElementById("object-count"),e=parseInt(n.value,10),t=document.getElementById("confirm-bucket-name"),a=document.getElementById("confirm-delete-objects"),i=document.getElementById("delete-btn");function s(){var r=t.value===c,l=e===0||a&&a.checked;i.disabled=!(r&&l)}t.addEventListener("input",s),a&&a.addEventListener("change",s),u.addEventListener("submit",function(r){return m(function(){var l,d,v;return y(this,function(f){switch(f.label){case 0:r.preventDefault(),f.label=1;case 1:return f.trys.push([1,3,,4]),l=e>0,[4,N(c,l)];case 2:return f.sent(),window.location.href="/admin/buckets",[3,4];case 3:return d=f.sent(),v=I(d,Error)?d.message:String(d),j(v),[3,4];case 4:return[2]}})})()})}function S(){F(),T()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S();
